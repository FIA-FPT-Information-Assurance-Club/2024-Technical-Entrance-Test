
<font size="10">simplersa</font>

​		10<sup>th</sup> March 2024

​		Challenge Author(s): Randomteuz

​		

 
### Description:

Just plain simple rsa, I even dropped some hints. Should be pretty easy for you.

### Objective

Find the original flag that is encrypted

### Difficulty:

`easy`

### Flag:

`FIA{M4tH_1s_Crypt0_fUnd4M3nT4L}`



# Challenge
simplersa.py

```
from Crypto.Util.number import bytes_to_long, getPrime
from secret import flag


def RSA_encrypt(message):
    m = bytes_to_long(message)
    p = getPrime(1024)
    q = getPrime(1024)
    hint1 = p + q
    hint2 = (p-1)*(q-1)
    N = p * q
    e = 65537
    c = pow(m, e, N)
    return N, e, c,hint1,hint2


m=flag
N, e, c,hint1,hint2 = RSA_encrypt(m)
print(f"n = {N}")
print(f"e = {e}")
print(f"c = {c}")
print(f"hint1 = {hint1}")
print(f"hint2 = {hint2}")
```

output.txt
```
n = 24736639682174736910154746181631384715425080475424293737206742880502803644642618784547077207823837284451195556959359155259541895359244802573798400990803440633000754135448649353253837334491043787489547146543133298312385650180850708859925599310182266129760217343996725944105737598733634492155919496634324655821707705634405792472759628779207955041310232311049266144732081356997303704613690203710924483670341946416651010173230884445296530008699776718536197977072297690625836796738585748206646876129574650004357451893662654310900222544660234185879327749285169955414965029968238143524154567384223239662750796218865466075543
e = 65537
c = 14635063564803521643445936389853795386972363965535032190123924398100907237050267162684788310094592499270146985171574014303488060697558613990537717690694864631861400114034097866080586213824610216876134994730714029797140214438267874381194123881515316483491857765017785577236480368930524599118029019420122660187859903769536844248314620115175379707057398403580695363943417779261333814515311008320921918143894826113800302163834743898395955457555930587041518629948520476651511699745815810940034624847883701256191649611793120021903400609102513466292344966497124342189138917457165075567639911469449619001294160279046283776453
hint1 = 317020465657781455254100301345760073215661461937262709768037089897315070621105666307105129922886451459675480005500252867465539614082874204061969290351329452803017666280494080676367599050370014529444456447933221260077038355470407654272583211257454266770107714856323348902167462178015797163600567539699696858704       
hint2 = 24736639682174736910154746181631384715425080475424293737206742880502803644642618784547077207823837284451195556959359155259541895359244802573798400990803440633000754135448649353253837334491043787489547146543133298312385650180850708859925599310182266129760217343996725944105737598733634492155919496634324655821390685168748011017505528477862194968094570849112003434964044267099988633992584537403819353747455494956975530167730631577830990394616902514474228686720968237822819130458091667530279277079204635474912995445729433050823184189189826531606744538027715688644857315111914794621987105206207442499150228679165769216840
```

# Solver

Given the hint1 and hint 2, one can solve the equation to find p and q

```
from sympy import symbols, solve
# Given hints
hint1 = 317020465657781455254100301345760073215661461937262709768037089897315070621105666307105129922886451459675480005500252867465539614082874204061969290351329452803017666280494080676367599050370014529444456447933221260077038355470407654272583211257454266770107714856323348902167462178015797163600567539699696858704       
hint2 = 24736639682174736910154746181631384715425080475424293737206742880502803644642618784547077207823837284451195556959359155259541895359244802573798400990803440633000754135448649353253837334491043787489547146543133298312385650180850708859925599310182266129760217343996725944105737598733634492155919496634324655821390685168748011017505528477862194968094570849112003434964044267099988633992584537403819353747455494956975530167730631577830990394616902514474228686720968237822819130458091667530279277079204635474912995445729433050823184189189826531606744538027715688644857315111914794621987105206207442499150228679165769216840

# Define symbols for p and q
p, q = symbols('p q')

# Equation 1: p + q = hint1
equation1 = p + q - hint1

# Equation 2: (p-1) * (q-1) = hint2
equation2 = (p - 1) * (q - 1) - hint2

# Solve the system of equations
solution = solve((equation1, equation2), (p, q))

# Print the solutions
print("p =", solution[0][0])
print("q =", solution[0][1])

```

Having p and q, the rest of it is just finding the private key and decrypt the ciphertext


```
p = int(solution[0][0])
q = int(solution[0][1])

N = 24736639682174736910154746181631384715425080475424293737206742880502803644642618784547077207823837284451195556959359155259541895359244802573798400990803440633000754135448649353253837334491043787489547146543133298312385650180850708859925599310182266129760217343996725944105737598733634492155919496634324655821707705634405792472759628779207955041310232311049266144732081356997303704613690203710924483670341946416651010173230884445296530008699776718536197977072297690625836796738585748206646876129574650004357451893662654310900222544660234185879327749285169955414965029968238143524154567384223239662750796218865466075543
e = 65537
c = 14635063564803521643445936389853795386972363965535032190123924398100907237050267162684788310094592499270146985171574014303488060697558613990537717690694864631861400114034097866080586213824610216876134994730714029797140214438267874381194123881515316483491857765017785577236480368930524599118029019420122660187859903769536844248314620115175379707057398403580695363943417779261333814515311008320921918143894826113800302163834743898395955457555930587041518629948520476651511699745815810940034624847883701256191649611793120021903400609102513466292344966497124342189138917457165075567639911469449619001294160279046283776453

phi_n=(p-1)*(q-1)
d = pow(e,-1,phi_n)
m = pow(c,d,N)

from Crypto.Util.number import long_to_bytes
print(long_to_bytes(m))
```

